landscapeFreqBrand %>%
ggplot(., aes(x = reorder(source,n), y = n)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~word, scales = "free") +
ylab("Number of publications") +
xlab("Source") +
ggtitle("Media landscape by brand") +
#  theme_bw() +
#  theme(axis.text.x=element_text(angle=45,hjust=1))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(angle=45,hjust=1))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(source,n), y = n)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~word, scales = "free") +
ylab("Number of publications") +
xlab("Source") +
ggtitle("Media landscape by brand") +
#  theme_bw() +
#  theme(axis.text.x=element_text(angle=45,hjust=1))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(angle=90,hjust=1))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(source,n), y = n)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~word, scales = "free") +
ylab("Number of publications") +
xlab("Source") +
ggtitle("Media landscape by brand") +
#  theme_bw() +
#  theme(axis.text.x=element_text(angle=45,hjust=1))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(angle=35,hjust=1))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(source,n), y = n)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~word, scales = "free") +
ylab("Number of publications") +
xlab("Source") +
ggtitle("Media landscape by brand") +
#  theme_bw() +
#  theme(axis.text.x=element_text(angle=45,hjust=1))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(angle=35,hjust=1))
landscapeFreqBrand %>%
ggplot(., aes(x = reorder(source,n), y = n)) +
geom_bar(stat = "identity", alpha = 1) +
facet_wrap(~word, scales = "free") +
ylab("Number of publications") +
xlab("Source") +
ggtitle("Media landscape by brand") +
#  theme_bw() +
#  theme(axis.text.x=element_text(angle=45,hjust=1))
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x=element_text(angle=35,hjust=1))
xiaomi <- readxl::read_excel("../Dta/Xiaomi full.xlsx", sheet = "2") %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-published,-indexed,-category,-image,-languages) %>%
cbind.data.frame(Datum)
xiaomi <- readxl::read_excel("../Dta/Xiaomi full.xlsx", sheet = "Facebook") %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-published,-indexed,-category,-image,-languages) %>%
cbind.data.frame(Datum)
xiaomi <- readxl::read_excel("../Dta/Xiaomi full.xlsx", sheet = "Facebook") %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-published,-indexed,-category,-image,-languages)
View(xiaomi)
xiaomi <- readxl::read_excel("../Dta/Xiaomi full.xlsx", sheet = "Facebook") %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(published,-indexed,-category,-image,-languages) %>%
cbind.data.frame(Datum)
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx", sheet = "Facebook") %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-indexed,-category,-image,-languages)
View(facebook)
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
col_types = c("skip","skip","skip","skip","date")) %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-indexed,-category,-image,-languages)
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
guess_max = 1048576)) %>%
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
guess_max = 1048576) %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-indexed,-category,-image,-languages)
View(facebook)
site_data_columns <- read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook")
library(re)
library(readxl)
site_data_columns <- read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook")
site_data_column_names <- colnames(site_data_columns)
for(i in 1 : length(site_data_column_names)){
#where date is a column name
if(site_data_column_names[i] == "date"){
column_data_types[i] <- "date"
#where result is a column name
} else if (site_data_column_names[i] == "result") {
column_data_types[i] <- "numeric"
} else{
column_data_types[i] <- "text"
}
}
column_data_types <- c()
for(i in 1 : length(site_data_column_names)){
#where date is a column name
if(site_data_column_names[i] == "date"){
column_data_types[i] <- "date"
#where result is a column name
} else if (site_data_column_names[i] == "result") {
column_data_types[i] <- "numeric"
} else{
column_data_types[i] <- "text"
}
}
column_data_types
str(facebook)
column_data_types[5] <- "date"
column_data_types
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
col_types = column_data_types) %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-indexed,-category,-image,-languages)
str(facebook)
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
col_types = column_data_types) %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select("Date" = na,-indexed,-category,-image,-languages)
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
col_types = column_data_types) %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select("Date" = na,-indexed,-category,-image,-languages, everything())
facebook <- readxl::read_excel("../Dta/Xiaomi full.xlsx",
sheet = "Facebook",
col_types = column_data_types) %>%
row_to_names(.,1) %>%
clean_names() %>%
#  select(-c(1,17:25,28:33,37:41)) %>%
select(-indexed,-category,-image,-languages) %>%
rename(Date = na)
facebook %>%
group_by(type) %>%
summarise(impressions = sum(impressions, na.rm = TRUE))
facebook %>%
mutate(impressions = as.numeric()) &>&
facebook %>%
mutate(impressions = as.numeric()) %>%
group_by(type) %>%
summarise(impressions = sum(impressions, na.rm = TRUE))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(impressions = sum(impressions, na.rm = TRUE))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(TotalImpressions = sum(impressions, na.rm = TRUE)) %>%
arrange(desc(impressions))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(TotalImpressions = sum(impressions, na.rm = TRUE)) %>%
arrange(desc(TotalImpressions))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE))%>%
arrange(desc(TotalImpressions))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE))%>%
arrange(desc(Impressions))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE))%>%
arrange(desc(Impressions))
facebook %>%
mutate(impressions = as.numeric(impressions)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
#   Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE))%>%
arrange(desc(Impressions))
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE))%>%
arrange(desc(Impressions))
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE))%>%
arrange(desc(Impressions))
Publications = count())%>%
Publications = n())%>%
Publications = count)%>%
Publications = n()) %>%
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)
Publications = n()) %>%
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
group_by(type) %>%
summarise(Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE),
Publications = n()) %>%
arrange(desc(Impressions))
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
group_by(type) %>%
summarise(Publications = n(),
Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)) %>%
arrange(desc(Impressions))
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
group_by(type) %>%
summarise(Publications = n(),
Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)) %>%
arrange(desc(Publications))
fbStat %>%
kable() %>%
kable_styling()
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
group_by(type) %>%
summarise(Publications = n(),
Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)) %>%
arrange(desc(Publications)) -> fbStat
fbStat %>%
kable() %>%
kable_styling()
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
rename(Activity = type) %>%
group_by(Activity) %>%
summarise(Publications = n(),
Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)) %>%
arrange(desc(Publications)) -> fbStat
fbStat %>%
kable() %>%
kable_styling()
fbDta %>%
group_by(Activity) %>%
summarise(Publications = n(),
Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)) %>%
arrange(desc(Publications)) -> fbStat
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes)) %>%
rename(Activity = type) -> fbDta
fbDta %>%
group_by(Activity) %>%
summarise(Publications = n(),
Impressions = sum(impressions, na.rm = TRUE),
Comments = sum(comments, na.rm = TRUE),
Engagements = sum(engagements, na.rm = TRUE),
Likes = sum(likes, na.rm = TRUE)) %>%
arrange(desc(Publications)) -> fbStat
View(fbDta)
fbDta %>%
top_n(.,10, wt = "comments")
fbDta %>%
top_n(.,10, wt = "comments")kable() %>%
fbDta %>%
top_n(.,10, wt = "comments") %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "500px", height = "400px")
fbDta %>%
top_n(.,10, wt = "comments") %>%
select(text, Activity, url, impressions, engagements, likes, Date)
fbDta %>%
top_n(.,10, wt = "comments") %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "500px", height = "400px")
fbDta %>%
top_n(.,10, wt = "comments") %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
top_n(.,10, wt = "type") %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
top_n(.,10, wt = "impressions") %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
top_n(.,10, wt = "impressions") %>%
arrange(desc(impressions)) %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
top_n(.,10, wt = "engagement") %>%
arrange(desc(impressions)) %>%
select(text, engagement, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
names(fbDta)
fbDta %>%
top_n(.,10, wt = "engagements") %>%
arrange(desc(engagements)) %>%
select(text, engagements, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
top_n(.,10, wt = "engagements") %>%
arrange(desc(engagements)) %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
View(fbDta)
fbDta %>%
top_n(.,10, wt = "likes") %>%
arrange(desc(likes)) %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
View(fbDta)
fbDta %>%
group_by(author)
fbDta %>%
group_by(author) %>%
top_n(.,3, wt = "impressions") %>%
arrange(desc(impressions)) %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
group_by(author) %>%
top_n(.,10, wt = "impressions") %>%
arrange(desc(impressions)) %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
fbDta %>%
group_by(author) %>%
top_n(.,10, wt = "impressions") %>%
arrange(desc(impressions))
fbDta %>%
group_by(author) %>%
top_n(.,10, wt = "impressions") %>%
arrange(desc(impressions)) %>%
select(text, Activity, url, impressions, engagements, likes, Date)
fbDta %>%
group_by(author) %>%
top_n(.,5, wt = "impressions") %>%
arrange(desc(impressions)) %>%
select(text, Activity, url, impressions, engagements, likes, Date)
t
fbDta %>%
group_by(author) %>%
top_n(.,5, wt = "likes") %>%
arrange(desc(likes)) %>%
select(text, Activity, url, impressions, engagements, likes, Date) %>%
kable() %>%
kable_styling() %>%
scroll_box(width = "900px", height = "400px")
facebook %>%
mutate(impressions = as.numeric(impressions),
comments = as.numeric(comments),
engagements = as.numeric(engagements),
likes = as.numeric(likes),
audience = as.numeric(audience)) %>%
rename(Activity = type) -> fbDta
fbDta %>%
#group_by(author) %>%
top_n(.,5, wt = "audience") %>%
arrange(desc(audience))
fbDta %>%
#group_by(author) %>%
#top_n(.,5, wt = "audience") %>%
arrange(desc(audience))
fbDta %>%
#group_by(author) %>%
#top_n(.,5, wt = "audience") %>%
arrange(desc(audience)) %>%
select( author , audience, impressions, engagements, likes, Date)
fbDta %>%
group_by(author) %>%
#top_n(.,5, wt = "audience") %>%
arrange(desc(audience)) %>%
select( author , audience, impressions, engagements, likes, Date)
fbDta %>%
#group_by(author) %>%
top_n(.,5, wt = "audience")
fbDta %>%
#group_by(author) %>%
#top_n(.,5, wt = "audience") %>%
arrange(desc(audience))
fbDta %>%
group_by(author) %>%
#top_n(.,5, wt = "audience") %>%
arrange(desc(audience))
